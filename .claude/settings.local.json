{
  "permissions": {
    "allow": [
      "Bash(wc:*)",
      "Bash(git add:*)",
      "Bash(git commit:*)",
      "Bash(git push)",
      "WebSearch",
      "WebFetch(domain:medium.com)",
      "WebFetch(domain:mikhail.io)",
      "Bash(dotnet build:*)",
      "Bash(xargs:*)",
      "Bash(grep:*)",
      "Bash(tree:*)",
      "Bash(git mv:*)",
      "Bash(pwsh -File tests/Test-WorkerLocal.ps1)",
      "Bash(git status:*)",
      "Bash(git reset:*)",
      "Bash(git rm:*)",
      "Bash(dotnet test:*)",
      "Bash(dotnet restore:*)",
      "Bash(pwsh:*)",
      "Bash(dotnet run:*)",
      "Bash(az bicep build:*)",
      "Bash(python3:*)",
      "WebFetch(domain:dev.to)",
      "Bash(git -C /Users/me/Documents/GitHub/ma-toolkit-sandbox status)",
      "Bash(git -C /Users/me/Documents/GitHub/ma-toolkit-sandbox diff)",
      "Bash(git -C /Users/me/Documents/GitHub/ma-toolkit-sandbox log --oneline -5)",
      "Bash(git -C /Users/me/Documents/GitHub/ma-toolkit-sandbox push)",
      "Bash(gh label list:*)",
      "Bash(git -C /Users/me/Documents/GitHub/ma-toolkit-sandbox add src/automation/database/schema.sql src/automation/orchestrator/src/Orchestrator.Functions/Services/Handlers/MemberAddedHandler.cs src/automation/orchestrator/src/Orchestrator.Functions/Services/Handlers/PhaseDueHandler.cs src/automation/orchestrator/src/Orchestrator.Functions/Services/Handlers/ResultProcessor.cs src/automation/scheduler/src/Scheduler.Functions/Functions/SchedulerTimerFunction.cs src/automation/scheduler/src/Scheduler.Functions/Services/BatchDetector.cs src/automation/scheduler/src/Scheduler.Functions/Services/PhaseDispatcher.cs src/automation/scheduler/src/Scheduler.Functions/Services/VersionTransitionHandler.cs src/automation/shared/MaToolkit.Automation.Shared/Constants/PhaseStatus.cs src/automation/shared/MaToolkit.Automation.Shared/Services/Repositories/BatchRepository.cs src/automation/shared/MaToolkit.Automation.Shared/Services/Repositories/IBatchRepository.cs src/automation/shared/MaToolkit.Automation.Shared/Services/Repositories/IPhaseExecutionRepository.cs src/automation/shared/MaToolkit.Automation.Shared/Services/Repositories/PhaseExecutionRepository.cs)",
      "Bash(git -C /Users/me/Documents/GitHub/ma-toolkit-sandbox add docs/code-review-2026-02-07.md)",
      "Bash(git -C /Users/me/Documents/GitHub/ma-toolkit-sandbox commit -m \"$\\(cat <<''EOF''\nUpdate code review doc with version transition fixes \\(issue #4.11\\)\n\nCo-Authored-By: Claude Opus 4.6 <noreply@anthropic.com>\nEOF\n\\)\")",
      "Bash(git -C /Users/me/Documents/GitHub/ma-toolkit-sandbox add src/automation/database/schema.sql src/automation/shared/MaToolkit.Automation.Shared/Models/Db/RunbookRecord.cs src/automation/shared/MaToolkit.Automation.Shared/Services/Repositories/IRunbookRepository.cs src/automation/shared/MaToolkit.Automation.Shared/Services/Repositories/RunbookRepository.cs src/automation/scheduler/src/Scheduler.Functions/Functions/SchedulerTimerFunction.cs src/automation/admin-api/src/AdminApi.Functions/Functions/GetRunbookFunction.cs src/automation/admin-api/src/AdminApi.Functions/Functions/ListRunbooksFunction.cs src/automation/admin-cli/src/AdminCli/Models/ApiModels.cs src/automation/admin-cli/src/AdminCli/Commands/RunbookCommands.cs)",
      "Bash(git -C /Users/me/Documents/GitHub/ma-toolkit-sandbox commit -m \"$\\(cat <<''EOF''\nSurface scheduler processing errors on runbook records \\(issue #4.5\\)\n\nPersist last_error/last_error_at on runbook records when scheduler processing\nfails, escalate logging to LogCritical, clear on success. Error state is\nsurfaced through admin API responses and displayed in CLI tables.\n\nCo-Authored-By: Claude Opus 4.6 <noreply@anthropic.com>\nEOF\n\\)\")",
      "Bash(git -C /Users/me/Documents/GitHub/ma-toolkit-sandbox add src/automation/cloud-worker/src/auth.ps1 src/automation/cloud-worker/src/runspace-manager.ps1 docs/code-review-2026-02-07.md)",
      "Bash(git -C /Users/me/Documents/GitHub/ma-toolkit-sandbox commit -m \"$\\(cat <<''EOF''\nRefresh EXO access token during cloud-worker lifetime \\(issue #4.6\\)\n\nStore auth config in runspace globals during init, add proactive refresh\nat 45-min threshold before each job, and reactive refresh on 401/expired\ntoken errors in the retry loop.\n\nCo-Authored-By: Claude Opus 4.6 <noreply@anthropic.com>\nEOF\n\\)\")",
      "Bash(git -C /Users/me/Documents/GitHub/ma-toolkit-sandbox add src/automation/cloud-worker/src/job-dispatcher.ps1 docs/code-review-2026-02-07.md)",
      "Bash(git -C /Users/me/Documents/GitHub/ma-toolkit-sandbox commit -m \"$\\(cat <<''EOF''\nDefense-in-depth for idle timeout during active jobs \\(issue #4.7\\)\n\nReset lastActivityTime when active jobs exist so the idle timer stays\nfresh even if future changes weaken the activeJobs.Count guard. The\nexisting guard already prevented the timeout from firing mid-job.\n\nCo-Authored-By: Claude Opus 4.6 <noreply@anthropic.com>\nEOF\n\\)\")",
      "Bash(git -C /Users/me/Documents/GitHub/ma-toolkit-sandbox add src/automation/cloud-worker/src/throttle-handler.ps1 src/automation/cloud-worker/src/worker.ps1 src/automation/cloud-worker/tests/Test-WorkerLocal.ps1 src/automation/cloud-worker/CLAUDE.md src/automation/cloud-worker/README.md docs/code-review-2026-02-07.md)",
      "Bash(git -C /Users/me/Documents/GitHub/ma-toolkit-sandbox commit -m \"$\\(cat <<''EOF''\nRemove unused throttle-handler.ps1 \\(issue #4.8\\)\n\nRetry logic lives inline in runspace-manager.ps1 \\(must be inline since\nfunctions defined outside a runspace aren''t available inside it\\).\nRemoved the dead file and all references from worker.ps1, tests, and docs.\n\nCo-Authored-By: Claude Opus 4.6 <noreply@anthropic.com>\nEOF\n\\)\")",
      "Bash(git -C /Users/me/Documents/GitHub/ma-toolkit-sandbox add src/automation/cloud-worker/src/config.ps1 src/automation/cloud-worker/src/job-dispatcher.ps1 infra/automation/cloud-worker/deploy.bicep src/automation/cloud-worker/docker-compose.yml src/automation/cloud-worker/docs/architecture.md docs/code-review-2026-02-07.md)",
      "Bash(git -C /Users/me/Documents/GitHub/ma-toolkit-sandbox commit -m \"$\\(cat <<''EOF''\nMake shutdown grace period configurable \\(issue #4.9\\)\n\nAdd SHUTDOWN_GRACE_SECONDS env var \\(default 30\\) so operators can tune\nhow long the cloud-worker waits for in-flight jobs during shutdown.\n\nCo-Authored-By: Claude Opus 4.6 <noreply@anthropic.com>\nEOF\n\\)\")",
      "Bash(git -C /Users/me/Documents/GitHub/ma-toolkit-sandbox add docs/code-review-2026-02-07.md infra/automation/admin-api/deploy.bicep infra/automation/cloud-worker/deploy.bicep infra/automation/scheduler-orchestrator/deploy.bicep infra/shared/deploy.bicep src/automation/admin-api/src/AdminApi.Functions/Functions/BatchManagementFunction.cs src/automation/admin-api/src/AdminApi.Functions/Functions/HealthCheckFunction.cs src/automation/admin-api/src/AdminApi.Functions/Functions/MemberManagementFunction.cs src/automation/admin-api/tests/AdminApi.Functions.Tests/Auth/AuthorizationAttributeTests.cs src/automation/orchestrator/src/Orchestrator.Functions/Services/Handlers/PhaseDueHandler.cs src/automation/shared/MaToolkit.Automation.Shared/Services/DynamicTableManager.cs src/automation/shared/MaToolkit.Automation.Shared/Services/PhaseEvaluator.cs src/automation/shared/MaToolkit.Automation.Shared/Services/Repositories/BatchRepository.cs src/automation/shared/MaToolkit.Automation.Shared/Services/Repositories/IBatchRepository.cs)",
      "Bash(git -C /Users/me/Documents/GitHub/ma-toolkit-sandbox commit -m \"$\\(cat <<''EOF''\nFix all Tier 5 code review items \\(pre-production quality pass\\)\n\nSQL keyword filtering, JSON validation, batch pagination, health check\nendpoint, 409 status codes for state conflicts, PhaseDueHandler\nidempotency guard + dispatched status, diagnostic settings for SQL/KV,\nstorage deny-by-default, KEDA cooldown/polling config.\n\nCo-Authored-By: Claude Opus 4.6 <noreply@anthropic.com>\nEOF\n\\)\")",
      "WebFetch(domain:demiliani.com)",
      "WebFetch(domain:github.com)",
      "Bash(git -C /Users/me/Documents/GitHub/ma-toolkit-sandbox add infra/automation/scheduler-orchestrator/deploy.bicep infra/automation/admin-api/deploy.bicep src/automation/scheduler/src/Scheduler.Functions/Services/BlobLeaseDistributedLock.cs)",
      "Bash(git -C /Users/me/Documents/GitHub/ma-toolkit-sandbox commit -m \"$\\(cat <<''EOF''\nSwitch AzureWebJobsStorage to identity-based connections, fix admin-api publicNetworkAccess\n\nReplace account key connection strings with AzureWebJobsStorage__accountName\n\\(managed identity\\) for all 3 Function Apps. Add Storage Blob Data Owner and\nStorage Table Data Contributor RBAC assignments on each storage account.\nUpdate BlobLeaseDistributedLock to use DefaultAzureCredential. Add missing\npublicNetworkAccess to admin-api Function App to match scheduler/orchestrator.\n\nCo-Authored-By: Claude Opus 4.6 <noreply@anthropic.com>\nEOF\n\\)\")",
      "Bash(git -C /Users/me/Documents/GitHub/ma-toolkit-sandbox add CLAUDE.md infra/automation/admin-api/deploy.bicep infra/automation/admin-api/deploy.parameters.json infra/automation/scheduler-orchestrator/deploy.bicep infra/automation/scheduler-orchestrator/deploy.parameters.json)",
      "Bash(git -C /Users/me/Documents/GitHub/ma-toolkit-sandbox commit -m \"$\\(cat <<''EOF''\nSwitch SQL auth to Entra ID managed identity, eliminate password-based connections\n\nReplace SQL login/password connection strings with Active Directory Managed\nIdentity auth for all three .NET Function Apps \\(scheduler, orchestrator,\nadmin-api\\). Add Entra ID administrator resource on the SQL server. Admin-api\nnow takes sqlServerFqdn/sqlDatabaseName params instead of a @secure\\(\\)\nconnection string. Post-deployment SQL DDL required to create contained\ndatabase users for each function app''s managed identity.\n\nCo-Authored-By: Claude Opus 4.6 <noreply@anthropic.com>\nEOF\n\\)\")",
      "Bash(git -C /Users/me/Documents/GitHub/ma-toolkit-sandbox add src/automation/orchestrator/src/Orchestrator.Functions/Services/Handlers/ResultProcessor.cs src/automation/orchestrator/src/Orchestrator.Functions/Services/Handlers/PollCheckHandler.cs src/automation/orchestrator/src/Orchestrator.Functions/Services/RollbackExecutor.cs src/automation/orchestrator/tests/Orchestrator.Functions.Tests/Services/Handlers/ResultProcessorTests.cs)",
      "Bash(git -C /Users/me/Documents/GitHub/ma-toolkit-sandbox commit -m \"$\\(cat <<''EOF''\nLoad member data for rollback template resolution in orchestrator\n\nRollback sequences using member-specific templates \\(e.g. {{TargetObjectId}}\\)\nwere never resolved because all callers passed null for memberData. Now\nResultProcessor and PollCheckHandler load member data via IMemberRepository\n+ DynamicTableReader before invoking rollback, matching the existing pattern\nin MemberRemovedHandler. Also make rollback job IDs per-member unique.\n\nCo-Authored-By: Claude Opus 4.6 <noreply@anthropic.com>\nEOF\n\\)\")",
      "Bash(git -C /Users/me/Documents/GitHub/ma-toolkit-sandbox add src/automation/runbooks/user-migration.yaml)",
      "Bash(git -C /Users/me/Documents/GitHub/ma-toolkit-sandbox commit -m \"$\\(cat <<''EOF''\nAdd multi-step cutover rollback to user-migration runbook\n\nReplace single-step rollback-email with rollback-cutover that reverts the\nprimary email, clears Exchange GUIDs, and sends an admin alert — exercising\nthe member data loading fix for per-member template resolution in rollbacks.\n\nCo-Authored-By: Claude Opus 4.6 <noreply@anthropic.com>\nEOF\n\\)\")",
      "Bash(git -C /Users/me/Documents/GitHub/ma-toolkit-sandbox add src/automation/shared/MaToolkit.Automation.Shared/Services/Repositories/IMemberRepository.cs src/automation/shared/MaToolkit.Automation.Shared/Services/Repositories/MemberRepository.cs src/automation/scheduler/src/Scheduler.Functions/Services/MemberSynchronizer.cs src/automation/scheduler/Scheduler.sln src/automation/scheduler/tests/Scheduler.Functions.Tests/Scheduler.Functions.Tests.csproj src/automation/scheduler/tests/Scheduler.Functions.Tests/Services/MemberSynchronizerTests.cs)",
      "Bash(git -C /Users/me/Documents/GitHub/ma-toolkit-sandbox commit -m \"$\\(cat <<''EOF''\nRefresh member data_json on every scheduler tick\n\nRe-query data source results are already in memory on each 5-minute tick.\nNow bulk-update data_json for all active members still present in query\nresults so downstream phases always use the latest attribute values\ninstead of the stale point-in-time snapshot from initial insertion.\n\nCo-Authored-By: Claude Opus 4.6 <noreply@anthropic.com>\nEOF\n\\)\")",
      "Bash(git -C /Users/me/Documents/GitHub/ma-toolkit-sandbox add src/automation/scheduler/CLAUDE.md)",
      "Bash(git -C /Users/me/Documents/GitHub/ma-toolkit-sandbox commit -m \"$\\(cat <<''EOF''\nUpdate scheduler CLAUDE.md with test project and data refresh docs\n\nCo-Authored-By: Claude Opus 4.6 <noreply@anthropic.com>\nEOF\n\\)\")",
      "Bash(gh issue create:*)",
      "Bash(gh issue list:*)",
      "Bash(gh issue close:*)",
      "Bash(gh label create:*)",
      "Bash(gh label:*)",
      "Bash(gh issue view:*)",
      "Bash(git -C /Users/me/Documents/GitHub/ma-toolkit-sandbox add infra/automation/admin-api/deploy.bicep infra/automation/admin-api/deploy.parameters.json)",
      "Bash(git -C /Users/me/Documents/GitHub/ma-toolkit-sandbox commit -m \"$\\(cat <<''EOF''\nAdd missing Service Bus config to admin-api Bicep template \\(fixes #12\\)\n\nThe admin-api ServiceBusPublisher requires a Service Bus connection but\nthe deployment template was missing the namespace parameter, app setting,\nand RBAC role assignment. Add serviceBusNamespaceName param, the\nAdminApi__ServiceBusNamespace app setting, and Service Bus Data Sender\nrole assignment on the namespace.\n\nCo-Authored-By: Claude Opus 4.6 <noreply@anthropic.com>\nEOF\n\\)\")",
      "Bash(az version:*)",
      "Bash(git -C /Users/me/Documents/GitHub/ma-toolkit-sandbox remote -v)",
      "Bash(az bicep version:*)",
      "Bash(az bicep list-versions:*)",
      "Bash(git remote get-url:*)",
      "Bash(find:*)",
      "Bash(git -C /Users/me/Documents/GitHub/ma-toolkit-sandbox add infra/shared/deploy.bicep infra/automation/scheduler-orchestrator/deploy.parameters.json infra/automation/admin-api/deploy.parameters.json infra/automation/cloud-worker/deploy.parameters.json)",
      "Bash(git -C /Users/me/Documents/GitHub/ma-toolkit-sandbox commit -m \"$\\(cat <<''EOF''\nFix shared Bicep deployment error and warnings\n\nRename Service Bus namespace suffix from -sb \\(reserved\\) to -sbus, remove\nunsupported tags from Service Bus topic resources \\(BCP187\\), add @minLength\\(3\\)\nto baseName param \\(BCP334\\), and replace hardcoded SQL DNS zone name with\nenvironment\\(\\).suffixes.sqlServerHostname \\(no-hardcoded-env-urls\\).\n\nCo-Authored-By: Claude Opus 4.6 <noreply@anthropic.com>\nEOF\n\\)\")",
      "Bash(git -C /Users/me/Documents/GitHub/ma-toolkit-sandbox log --oneline -3)",
      "Bash(echo:*)",
      "Bash(git -C /Users/me/Documents/GitHub/ma-toolkit-sandbox add infra/shared/deploy.bicep)",
      "Bash(git -C /Users/me/Documents/GitHub/ma-toolkit-sandbox commit -m \"$\\(cat <<''EOF''\nMake Service Bus private endpoint conditional on Premium SKU \\(fixes deploy-infra\\)\n\nThe shared infra deployment failed with PrivateEndpointInvalidSku because\nthe SB private endpoint was deployed unconditionally against a Standard SKU\nnamespace. Add serviceBusSku parameter \\(default Standard\\), parameterize the\nSKU on the namespace resource, and gate sbPrivateEndpoint + sbDnsGroup on\nPremium. DNS zone and VNet link remain unconditional.\n\nCo-Authored-By: Claude Opus 4.6 <noreply@anthropic.com>\nEOF\n\\)\")",
      "Bash(git -C /Users/me/Documents/GitHub/ma-toolkit-sandbox diff infra/automation/scheduler-orchestrator/deploy.bicep)",
      "Bash(git -C /Users/me/Documents/GitHub/ma-toolkit-sandbox add infra/automation/scheduler-orchestrator/deploy.bicep)",
      "Bash(git -C /Users/me/Documents/GitHub/ma-toolkit-sandbox commit -m \"$\\(cat <<''EOF''\nInline SQL Server Entra admin config to satisfy Azure Policy at creation time\n\nThe MCAPS deny policy requires azureADOnlyAuthentication on the SQL Server\nresource at creation time. Move Entra admin and Entra-only auth from separate\nchild resources into the server''s properties.administrators block.\n\nCo-Authored-By: Claude Opus 4.6 <noreply@anthropic.com>\nEOF\n\\)\")",
      "Bash(/opt/homebrew/bin/az bicep build:*)",
      "Bash(gh run list:*)",
      "Bash(gh run view:*)",
      "Bash(git -C /Users/me/Documents/GitHub/ma-toolkit-sandbox add .github/workflows/deploy-infra.yml CLAUDE.md infra/automation/scheduler-orchestrator/deploy.bicep infra/automation/scheduler-orchestrator/deploy.parameters.json)",
      "Bash(git -C /Users/me/Documents/GitHub/ma-toolkit-sandbox commit -m \"$\\(cat <<''EOF''\nRemove SQL admin credentials from Entra-only SQL Server \\(fixes deploy-infra\\)\n\nThe deploy-infra workflow fails with AadOnlyAuthenticationIsEnabled because\nARM rejects administratorLogin/administratorLoginPassword when\nazureADOnlyAuthentication is true. Remove the sqlAdminLogin and\nsqlAdminPassword parameters from the Bicep template, parameters file,\nGitHub Actions workflow, and CLAUDE.md deployment docs.\n\nCo-Authored-By: Claude Opus 4.6 <noreply@anthropic.com>\nEOF\n\\)\")",
      "WebFetch(domain:raw.githubusercontent.com)",
      "Bash(git -C /Users/me/Documents/GitHub/ma-toolkit-sandbox add .github/workflows/deploy-infra.yml infra/automation/admin-api/deploy.bicep infra/automation/scheduler-orchestrator/deploy.bicep)",
      "Bash(git -C /Users/me/Documents/GitHub/ma-toolkit-sandbox commit -m \"$\\(cat <<''EOF''\nAdd uniqueString suffix to Function App names for global uniqueness\n\nAzure App Service names must be globally unique \\(*.azurewebsites.net\\).\nAppend uniqueString\\(resourceGroup\\(\\).id\\) to all three Function App names\n\\(scheduler, orchestrator, admin-api\\) — same pattern used for storage\naccounts. Remove obsolete one-time migration delete steps from deploy-infra\nworkflow since apps will be created with new unique names.\n\nCo-Authored-By: Claude Opus 4.6 <noreply@anthropic.com>\nEOF\n\\)\")",
      "Bash(git -C /Users/me/Documents/GitHub/ma-toolkit-sandbox add infra/automation/admin-api/deploy.bicep infra/automation/scheduler-orchestrator/deploy.bicep)",
      "Bash(git -C /Users/me/Documents/GitHub/ma-toolkit-sandbox commit -m \"$\\(cat <<''EOF''\nFix Storage Table Data Contributor role definition ID typo \\(fixes deploy-infra\\)\n\nThe role GUID ended in aafa but the correct Azure built-in role ID ends\nin aaa3 \\(0a9a7e1f-b9d0-4cc4-a60d-0319b160aaa3\\). This caused\nRoleDefinitionDoesNotExist errors during infrastructure deployment.\n\nCo-Authored-By: Claude Opus 4.6 <noreply@anthropic.com>\nEOF\n\\)\")",
      "Bash(gh workflow run:*)",
      "Bash(gh workflow:*)",
      "Bash(gh run watch:*)",
      "Bash(az functionapp list:*)",
      "Bash(git -C /Users/me/Documents/GitHub/ma-toolkit-sandbox commit -m \"$\\(cat <<''EOF''\nRemove publicNetworkAccess: Disabled from Function Apps \\(fixes deploy-apps\\)\n\nGitHub Actions runner gets 403 Forbidden on zip-deploy because\npublicNetworkAccess: Disabled blocks the public SCM endpoint. Remove it\nfrom all three Function Apps — VNet integration for outbound connectivity\nis preserved via virtualNetworkSubnetId + vnetRouteAllEnabled.\n\nCo-Authored-By: Claude Opus 4.6 <noreply@anthropic.com>\nEOF\n\\)\")",
      "Bash(git -C /Users/me/Documents/GitHub/ma-toolkit-sandbox commit -m \"$\\(cat <<''EOF''\nExplicitly set publicNetworkAccess: Enabled on Function Apps \\(fixes deploy-apps\\)\n\nOmitting publicNetworkAccess from the ARM template doesn''t reset it —\nthe previously deployed Disabled value persists. Explicitly set Enabled\nso the GitHub Actions runner can reach the SCM zip-deploy endpoint.\n\nCo-Authored-By: Claude Opus 4.6 <noreply@anthropic.com>\nEOF\n\\)\")",
      "Bash(git -C /Users/me/Documents/GitHub/ma-toolkit-sandbox add infra/automation/cloud-worker/deploy.bicep docs/deployment-guide.md)",
      "Bash(git -C /Users/me/Documents/GitHub/ma-toolkit-sandbox commit -m \"$\\(cat <<''EOF''\nUse per-instance certificate names for cloud-worker deployments\n\nDerive CERT_NAME from workerId \\(cert-worker-madev1, cert-worker-madev2\\)\ninstead of hardcoding worker-app-cert, so each instance authenticates to\nits target tenant with its own certificate. Update deployment guide step 14\nwith PEM-based import instructions for both instances.\n\nCo-Authored-By: Claude Opus 4.6 <noreply@anthropic.com>\nEOF\n\\)\")",
      "Bash(az keyvault show:*)",
      "Bash(az keyvault network-rule remove:*)",
      "Bash(az keyvault network-rule add:*)",
      "Bash(dotnet pack:*)",
      "Bash(az account show:*)",
      "Bash(dotnet tool install:*)",
      "Bash(matoolkit:*)",
      "Bash(az functionapp config appsettings list:*)",
      "Bash(az ad app update:*)",
      "Bash(az ad app show:*)",
      "Bash(az ad sp create:*)",
      "Bash(az rest:*)",
      "Bash(az functionapp log tail:*)",
      "Bash(az monitor app-insights query:*)",
      "Bash(az monitor app-insights component show:*)",
      "Bash(chmod:*)",
      "Bash(git -C /Users/me/Documents/GitHub/ma-toolkit-sandbox add infra/shared/deploy.bicep infra/automation/scheduler-orchestrator/deploy.bicep .github/workflows/deploy-infra.yml src/automation/database/deploy-schema.sh src/automation/database/migrations/001_initial_schema.sql)",
      "Bash(git -C /Users/me/Documents/GitHub/ma-toolkit-sandbox commit -m \"$\\(cat <<''EOF''\nAdd automated SQL schema deployment via Bicep deploymentScript\n\nAdd a VNet-connected ACI deployment script that runs sqlcmd with Entra ID\nmanaged identity auth to apply numbered SQL migrations during infra deployment.\nThis eliminates the manual step of running schema.sql against the database.\n\n- Add snet-deployment-scripts subnet \\(10.0.11.0/24\\) with ACI delegation\n- Add user-assigned managed identity + conditional deploymentScript resource\n- Create migration runner \\(deploy-schema.sh\\) with __schema_migrations tracking\n- Create 001_initial_schema.sql \\(idempotent IF NOT EXISTS for all 7 tables\\)\n- Wire subnet ID through deploy-infra.yml to scheduler-orchestrator deployment\n\nCo-Authored-By: Claude Opus 4.6 <noreply@anthropic.com>\nEOF\n\\)\")",
      "Bash(git -C /Users/me/Documents/GitHub/ma-toolkit-sandbox commit -m \"$\\(cat <<''EOF''\nAdd storage account for VNet-connected deployment script \\(fixes deploy-infra\\)\n\nAzure requires an existing storage account when running deploymentScripts\ninside a VNet. Add a dedicated storage account with access from the\ndeployment scripts subnet, and a Storage Blob Data Owner role assignment\nfor the schema managed identity.\n\nCo-Authored-By: Claude Opus 4.6 <noreply@anthropic.com>\nEOF\n\\)\")",
      "Bash(git -C /Users/me/Documents/GitHub/ma-toolkit-sandbox commit -m \"$\\(cat <<''EOF''\nAdd Storage service endpoint to deployment scripts subnet \\(fixes deploy-infra\\)\n\nThe schema deploy storage account uses a VNet rule allowing access from\nsnet-deployment-scripts, but the subnet was missing the Microsoft.Storage\nservice endpoint — matching the pattern used by scheduler/orchestrator subnets.\n\nCo-Authored-By: Claude Opus 4.6 <noreply@anthropic.com>\nEOF\n\\)\")",
      "Bash(git -C /Users/me/Documents/GitHub/ma-toolkit-sandbox commit -m \"$\\(cat <<''EOF''\nRemove firewall from schema deploy storage account \\(fixes deploy-infra\\)\n\nAzure deployment scripts with VNet integration don''t support storage\naccounts that have firewall/VNet rules enabled. Remove networkAcls\nfrom the temporary storage account used for script execution.\n\nCo-Authored-By: Claude Opus 4.6 <noreply@anthropic.com>\nEOF\n\\)\")",
      "Bash(git -C /Users/me/Documents/GitHub/ma-toolkit-sandbox commit -m \"$\\(cat <<''EOF''\nExplicitly set networkAcls defaultAction: Allow on schema storage \\(fixes deploy-infra\\)\n\nOmitting networkAcls doesn''t reset previously deployed Deny rules — same\npattern as publicNetworkAccess. Explicitly set Allow to clear the state.\n\nCo-Authored-By: Claude Opus 4.6 <noreply@anthropic.com>\nEOF\n\\)\")",
      "Bash(git -C /Users/me/Documents/GitHub/ma-toolkit-sandbox commit -m \"$\\(cat <<''EOF''\nExplicitly clear VNet/IP rules on schema storage account \\(fixes deploy-infra\\)\n\nThe first deployment created the storage account with virtualNetworkRules.\nSubsequent deployments keep failing the DeploymentScriptStorageAccount\npreflight check even with defaultAction: Allow. Explicitly empty the\nvirtualNetworkRules and ipRules arrays to clear leftover state.\n\nCo-Authored-By: Claude Opus 4.6 <noreply@anthropic.com>\nEOF\n\\)\")",
      "Bash(git -C /Users/me/Documents/GitHub/ma-toolkit-sandbox commit -m \"$\\(cat <<''EOF''\nRemove Storage service endpoint from deployment scripts subnet \\(fixes deploy-infra\\)\n\nAzure deployment scripts reject storage accounts when the ACI subnet has\na Microsoft.Storage service endpoint \\(DeploymentScriptStorageAccountWith\nServiceEndpointEnabled\\). Remove it — the schema deploy storage account\nuses defaultAction: Allow and doesn''t need VNet routing.\n\nCo-Authored-By: Claude Opus 4.6 <noreply@anthropic.com>\nEOF\n\\)\")",
      "Bash(git -C /Users/me/Documents/GitHub/ma-toolkit-sandbox commit -m \"$\\(cat <<''EOF''\nRename schema deploy storage account to force fresh creation \\(fixes deploy-infra\\)\n\nThe old stschema* account retained service endpoint metadata from the\ninitial deployment with VNet rules. Rename to stds* so ARM creates a\nclean account without legacy firewall state. The orphaned account\ncan be deleted manually.\n\nCo-Authored-By: Claude Opus 4.6 <noreply@anthropic.com>\nEOF\n\\)\")",
      "Bash(git push:*)",
      "Bash(az storage account list:*)",
      "Bash(az deployment group show:*)",
      "Bash(az sql server:*)",
      "Bash(az sql db list:*)",
      "Bash(curl:*)",
      "Bash(brew list:*)",
      "Bash(sqlcmd:*)",
      "Bash(az functionapp show:*)",
      "Bash(security find-generic-password:*)",
      "Bash(dotnet tool update:*)",
      "Bash(dotnet tool:*)",
      "Bash(MATOOLKIT_DEBUG=1 matoolkit batch create:*)",
      "Bash(MATOOLKIT_DEBUG=1 matoolkit batch advance:*)",
      "Bash(az servicebus topic show:*)",
      "Bash(az servicebus namespace list:*)",
      "Bash(az servicebus topic list:*)",
      "Bash(az servicebus topic subscription list:*)",
      "Bash(az functionapp function list:*)",
      "Bash(az functionapp deployment list:*)",
      "Bash(az webapp deployment:*)",
      "Bash(az servicebus namespace show:*)",
      "Bash(az servicebus topic subscription show:*)",
      "Bash(az monitor app-insights component list:*)",
      "Bash(az resource list:*)",
      "Bash(az servicebus topic subscription peek-lock:*)",
      "Bash(az servicebus topic subscription receive-message:*)",
      "Bash(az containerapp logs show:*)",
      "Bash(az containerapp list:*)",
      "Bash(az keyvault certificate show:*)",
      "Bash(az keyvault certificate delete:*)",
      "Bash(az keyvault certificate purge:*)",
      "Bash(az keyvault certificate recover:*)",
      "Bash(az keyvault certificate create:*)",
      "Bash(az containerapp show:*)",
      "Bash(az containerapp replica list:*)",
      "Bash(az containerapp revision list:*)",
      "Bash(az keyvault secret show:*)",
      "Bash(az keyvault secret list:*)",
      "Bash(az containerapp revision restart:*)",
      "Bash(az monitor log-analytics query:*)",
      "Bash(az servicebus topic subscription rule list --resource-group rg-ma-toolkit-sandbox --namespace-name matoolkit-sbus --topic-name worker-jobs --subscription-name worker-worker-madev1 -o json)",
      "Bash(az servicebus topic subscription peek --resource-group rg-ma-toolkit-sandbox --namespace-name matoolkit-sbus --topic-name worker-jobs --subscription-name worker-worker-madev1 --message-count 1 -o json)",
      "Bash(az monitor log-analytics workspace list:*)",
      "Bash(az role assignment list:*)",
      "Bash(dotnet publish:*)",
      "Bash(az functionapp deployment source config-zip:*)",
      "Bash(gh run rerun:*)",
      "Bash(az acr build:*)",
      "Bash(az containerapp update:*)",
      "Bash(git log:*)",
      "Bash(az servicebus topic authorization-rule delete:*)",
      "Bash(az servicebus namespace authorization-rule list:*)",
      "Bash(az servicebus namespace network-rule-set show:*)",
      "Bash(az servicebus namespace authorization-rule keys list:*)",
      "Bash(az servicebus topic authorization-rule list:*)",
      "WebFetch(domain:rikhepworth.com)",
      "WebFetch(domain:keda.sh)",
      "Bash(az provider show:*)",
      "Bash(az servicebus namespace authorization-rule delete:*)",
      "Bash(az keyvault list:*)",
      "Bash(az containerapp secret list:*)",
      "Bash(az monitor log-analytics workspace show:*)",
      "Bash(git -C /Users/me/Documents/GitHub/ma-toolkit-sandbox diff --stat)",
      "Bash(az ad sp show:*)",
      "Bash(az ad user show:*)",
      "Bash(az ad app permission admin-consent:*)",
      "Bash(az webapp auth show:*)",
      "Bash(git -C /Users/me/Documents/GitHub/ma-toolkit-sandbox log --oneline --all -- \"src/automation/admin-api/src/AdminApi.Functions/Functions/PublishRunbookFunction.cs\")",
      "Bash(git -C /Users/me/Documents/GitHub/ma-toolkit-sandbox log --oneline -10 -- \"src/automation/admin-api/\")",
      "Bash(az webapp auth update:*)",
      "Bash(az login:*)",
      "Bash(git -C /Users/me/Documents/GitHub/ma-toolkit-sandbox diff -- infra/automation/admin-api/deploy.bicep)",
      "Bash(git -C /Users/me/Documents/GitHub/ma-toolkit-sandbox add infra/automation/admin-api/deploy.bicep misc/test-user-provisioning.yaml)",
      "Bash(git -C /Users/me/Documents/GitHub/ma-toolkit-sandbox commit -m \"$\\(cat <<''EOF''\nRemove EasyAuth from admin-api, rely on code-level JWT auth\n\nEasyAuth was conflicting with the in-code Microsoft.Identity.Web\nmiddleware, causing 403s due to audience mismatches. All endpoints\nalready have [Authorize] attributes enforced by reflection-based\ntests, so platform-level auth is redundant. Also update\nprovision-madev1 phase offset to T-15m.\n\nCo-Authored-By: Claude Opus 4.6 <noreply@anthropic.com>\nEOF\n\\)\")",
      "Bash(git -C /Users/me/Documents/GitHub/ma-toolkit-sandbox push origin main)",
      "Bash(git -C /Users/me/Documents/GitHub/ma-toolkit-sandbox add src/automation/scheduler/src/Scheduler.Functions/Services/BlobLeaseDistributedLock.cs)",
      "Bash(git -C /Users/me/Documents/GitHub/ma-toolkit-sandbox commit -m \"$\\(cat <<''EOF''\nFix scheduler crash: lazy-init BlobServiceClient for distributed lock\n\nBlobLeaseDistributedLock is registered as a singleton, but on Flex\nConsumption cold start IConfiguration may not have resolved\nAzureWebJobsStorage__accountName yet during DI construction. Defer\nBlobServiceClient creation to first use via Lazy<T>.\n\nCo-Authored-By: Claude Opus 4.6 <noreply@anthropic.com>\nEOF\n\\)\")"
    ]
  }
}
